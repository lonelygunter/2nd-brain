\newpage
\section{Optimization models review}

% Scheduling
\subsection{Scheduling}

Nell'ambito dei problemi dello scheduling abbiamo degli elementi ben specificati:

\begin{itemize}
	\item \hl{task/job} già assegnati
	\item $n$ \hl{macchine/processori}
	\item potremmo attrezzare le macchine con dei \hl{tools}
\end{itemize}

Intendiamo \hl{allocare i tasks alla macchine in "overtime"} quindi capire anche la \hl{fascia temporale nella quale eseguire il task}. Potrebbe esserci un unico tempo di esecuzione oppure un task può avere dei tempi di esecuzione differenti su macchine differenti. 

L'output sarà un diagramma di Ganth.

\hl{I task possono avere degli istanti di rilascio} dove non potrebbe essere rilasciato dopo un certo istante di tempo (\hl{ready time}).

Possono esserci delle \hl{relazioni di precedenza tra i tasks}. Quindi non posso effettuare un task se prima non ho concluso l'altro.

Il diagramma mi dice nel tempo a che macchina è associato quale task ed in quali intervalli di tempo e con quale tool.


% Project scheduling
\subsection{Project scheduling}

Per progetto intendiamo un \hl{insieme di tasks che sono realizzati al fine di raggiungere un goal}. La caratteristica di un progetto è che nel complesso le attività non sono mai state eseguite in precedenza.

Le \hl{caratteristiche di un progetto} sono:


\begin{itemize}
	\item \textbf{durata delle attività} che nota
	\item ha \textbf{a capo un Project Manager}: responsabile del progetto e dei tempi di realizzazione, costi di produzione, ecc...
\end{itemize}

Un progetto è \hl{rappresentato da diverse attivita'} in una tabella fornita dal Project Manager:


\begin{table}[h!]
	\begin{center}
	\begin{tabular}{|c | c c |} 
		\hline
		Attività & Durata stimata $d_i$ & Predecessori \\ [0.5ex]
		\hline
 		1 & 10 & - \\
		2 & 10 & - \\
		3 & 10 & 1 \\
		4 & 10 & 1, 2 \\
		\hline
		\end{tabular}
	\end{center}
	\caption{Tabella di ore di lavoro e predecessioni delle attività}
	\label{tabatt}
\end{table}


e in un diagramma aciclico (Activity On Node (AoN)):


\begin{figure}[H]
\centering
\includegraphics[scale=0.4]{aon.jpeg}
\caption{Diagramma Activity On Node} 
\label{aon}
\end{figure}


dove abbiamo degli "archi" che rappresentano le predecessioni. Avremo anche dei \hl{vertici fittizzi}:

\begin{itemize}
	\item start: lo colleghiamo tutte le attività che non hanno predecessori
	\item end: ci colleghiamo tutte le attività finali
\end{itemize}

Una funzione fondamentale del Project Manager è la possibilità di accelerare alcune attività agendo su:

\begin{itemize}
	\item \hl{Variabili decisionali}:
		
		nel nostro caso, è lo \hl{start time $s_i$}. Ipotizziamo che il progetto inizi al tempo $t = 0$, quindi per ogni task abbiamo che:

			$$s_i >= 0\ \ \ \forall\ \ \ i \in TASKS$$

		In più possiamo definire \hl{$T >= 0$ tempo di completamento del progetto} (\textbf{completion time}).

		Minimizziamo il completion time:

			$$\min z = T$$

		con $z = 1T + 0s_1 + 0s_2 + ... + 0s_n$
		
		
	\item \hl{relazioni di precedenza}:
	
		relazioni che portano alcuni nodi a dipendere da altri:
		
		$$
		p_{ij}=
		\begin{cases} 
		    1 \Leftrightarrow i \in j \\ 
		    0 altrimenti
		\end{cases}$$
		
		con \hl{$p_{ij}$ matrice} costate e binaria:
		
		$$p =
		\left[ {\begin{array}{cccc}
		    0 & 0 & 1 & 1 \\
			0 & 0 & 0 & 1 \\
		    0 & 0 & 0 & 0 \\
		    0 & 0 & 0 & 0 \\
		\end{array} } \right]$$
		
	
	\item \hl{vincoli di precedenza}:
	
		Sia \hl{$T$ maggiorante del tempo di completamento delle task}:
			$$s_i + d_i <= T$$

		allora:

			$$p_{ij} (s_i + d_i) <= s_j\ \ \ \forall\ \ \ i,j \in TASKS$$

		Possiamo avere che:

		\begin{itemize}
			\item \hl{$p_{ij} = 1$}: allora \textbf{$i$ è predecessore di $j$} quindi il tempo di inizio del task $j$ deve essere successivo o uguale al task $i$ cioè $s_i + d_i$
	
			\item \hl{$p_ij = 0$}: $i$ non è predecessore quindi avremo $0 <= s_j$ allora il vincolo è ridondante
		\end{itemize}
		
		scriviamo allora:
 
		$$s_i + d_i <= s_j\ \ \ \forall\ \ \ i,j \in TASKS,\ p_{ij} >= 0$$


\end{itemize}


% Esempio
\subsection{Esempio }

Un modello espanso per problemi di istanza:

\begin{enumerate}
	\item funzione obiettibo: $\min z = T$
	\item vincoli:
		\begin{itemize}
			\item $s_1 + 10 <= T$
			\item $s_2 + 10 <= T$
			\item $s_3 + 10 <= T$
			\item $s_4 + 10 <= T$
			\item $s_1 + 10 <= s_3 (p_{13} = 1)$
			\item $s_1 + 10 <= s_4 (p_{14} = 1)$
			\item $s_2 + 10 <= s_4 (p_{24} = 1)$
			\item $s_1, s_2, s_3, s_4 >= 0$
			\item $T >= 0$
		\end{itemize}
\end{enumerate}


% Velocizzazione del progetto
\subsection{Velocizzazione del progetto}

Il Project Manager ha un \hl{budget} per poter velocizzare il progetto.

Se considero un \hl{task $i$ con durata non costante ($d_i^N$)}, avremo un valore nominale che dipende da un budget extra.

Il più semplice è l'\hl{andamento lineare} dove all'aumentare delle risorse la durata si riduce in modo lineare. Il che è vero finché non si incontra un \hl{vincolo inferiore $d_i^m$}.


Le \hl{3 risorse} alle quali si possono far riferimento sono le \hl{3M}:

\begin{itemize}
	\item Man
	\item Machine
	\item Money
\end{itemize}


quindi $d_i = d_i^N$.


\begin{figure}[H]
\centering
\includegraphics[scale=0.4]{budget.jpeg}
\caption{Diagramma budget} 
\label{budget}
\end{figure}


con:

\begin{itemize}
	\item \hl{pendenza w}: \textbf{riduzione della durata del task $i$} per unità di extra risorse (mesi di lavoro / k euro)
	\item $d_i = d_i^N - w_i x_i >= d_i^m$ vincolo del valore minimo per task
	\item $x_i$: denaro usato per il task $i$
	\item $B$: budget totale

\end{itemize}


% Esempio velocizzazione progetto
\subsection{Esempio velocizzazione progetto}

Avremo un modello con:

\begin{enumerate}
	\item funzione obiettivo: $\min z = T$
	\item vincoli:
		
		\begin{itemize}
			\item $s_i + d_i^N - w_i x_i <= T\ \ \ \forall\ \ \ i \in TASKS$
			\item $s_i + d_i^N - w_i x_i <= s_j\ \ \ \forall\ \ \ i, j \in TASKS, p_{ij} = 1$
			\item $d_i^N - w_i x_i >= d_i^m\ \ \ \forall\ \ \ i \in TASKS$
			\item $\sum_{i \in TASKS} x_i <= B$
			\item $T >= 0$
			\item $s_i >= 0\ \ \ \forall\ \ \ i \in TASKS$
			\item $x_i >= 0\ \ \ \forall\ \ \ i \in TASKS$
		\end{itemize}
\end{enumerate}


% Low sizing models
\subsection{Low sizing models}

Sono in genere usati da aziende manifatturiere. 


\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{prodline.jpeg}
\caption{Processo produtivo} 
\label{procprod}
\end{figure}


Supponendo di avere un \hl{tasso di domanda $d$} costante in base al tipo di prodotto. Ogni tipo di prodotto si differenzia dagli altri con una piccola modifica come può essere un differente gusto per una produzione di yogurt.

Questa differenziazione porta ad un \hl{costo di setup} delle macchine che andranno pulite, generando un costo fisso $k$.

Il livello di scorte sarà rappresentato con dei picchi con ampiezza $q$:


\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{invlev.jpeg}
\caption{Livello di inventario} 
\label{invlev}
\end{figure}


avendo una domanda costante, avremo una diminuzione lineare nello scorte di magazzino.

Ovviamente avremo dei \hl{costi medi di stockaggio $h$} dato che le scorte si "muoveranno" scambiandosi con altre scorte che entrano nel magazzino. Quindi andremo a calcolare il costo in base alla giacenza del \hl{numero di scorte medie $\frac{q}{2}$}.

In base alla strategia avremo:

\begin{enumerate}
	\item \hl{caso estermo}:
	
		gestione di tipo \textbf{just in time} dove \textbf{produco solo sotto commissione del cliente}.

		Avremo quindi:
		
		\begin{itemize}
			\item \textbf{livello di scorte molto basso} con un livello medio delle scorte molto basso e dei \textbf{costi di stockaggio bassi}
			\item \textbf{maggioramento dei costi del setup}
			\item pago $k$ più volte durante l'anno
		\end{itemize}
		
	\item \hl{caso produzione annua}:
	
		si produce un \textbf{quantitativo pari alla domanda annua}.
		
		Avremo quindi:
		
		\begin{itemize}
			\item grandi \textbf{costi di stockaggio}
			\item pago $k$ solo una volta all'anno
		\end{itemize}

\end{enumerate}


\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{casipart.jpeg}
\caption{Casi particolari} 
\label{casipart}
\end{figure}


% Scrivere il modello di ottimizzazione
\subsection{Scrivere il modello di ottimizzazione}

Le fasi da seguire prevedono la scrittura di:

\begin{enumerate}
	\item \hl{variabili decisionali}: variabile matematica per descrivere la mia decisione
	\item \hl{funzione obiettivo}: costo totale annuale composto dal \textbf{costo di scorta e quello di setup}
\end{enumerate}

Avremo allora:

$$z = k \frac{d}{q} + h \frac{q}{2} $$


Per la \hl{soluzione ottima}, faccio il gradiente:

$$\frac{dz}{dq} = 0 \Leftrightarrow -k \frac{d}{q^2} + \frac{h}{2} = 0$$


Concludiamo che il \hl{lotto economico}, per minimizzare i costi, sarà raggiunto da:

$$q^* = \sqrt{\frac{2kd}{h}}$$


\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{lottoec.jpeg}
\caption{Caso di lotto economico} 
\label{lottoec}
\end{figure}



Questo modello \hl{nella pratica ha dei limiti} dati i possibili vincoli come:

\begin{itemize}
	\item spazio limite di un magazzino
	\item produzione di più prodotti contemporaneamente
	\item vincolo di immobilizio
	\item vincolo sul capitale
	\item ecc ...
\end{itemize}


Associati al vincolo di immobilizzo possiamo avere anche un \hl{limite nei prodotti che posso fare di A e di B}. Se si ipotizza una domanda costante, ho che il \hl{costo totale annuale $z$} sarà data dal costo annuale di A e di B:

$$z = (k_A \frac{d_A}{q_A} + h_A \frac{q_A}{2}) + (k_B \frac{d_B}{q_B} + h_B \frac{q_B}{2})$$


Avremo che $z$ è dato da 2 termini uno che dipende da A ed uno da B. Per noi supponiamo che $k_A = k_B = k$.

Di conseguenza anche i lotti di approvvigionamento possono essere diversi. Quindi, quando è necessario, avremo che dovremo \hl{decidere quante confezioni produrre di A e quante di B}.

Nel \hl{caso peggiore ipotizzo che la produzione contemporanea di 2 lotti}, quindi non dovrà superare la capacità di magazzino $Q$:

$$q_A + q_B <= Q\ \ \ \forall\ \ \ q_A, q_B >= 0$$

dove la produzione contemporanea indica la \hl{sovrapposizione dei denti di sega}.

Se la \hl{capacita' del magazzino e' minore del lotto economico, la soluzione ottima sara' la nostra capacita'} e non più $q^*$.

Per il \hl{vincolo del capitale}, indiciamo con $c_A$ e $c_B$ il valore di un singolo prodotto di A e B allora:

$$c_Aq_A + c_Bq_B <= C$$

con $C$ capitale massimo.

Dal \hl{punto di vista grafico} avremo 2 variabili $q_A$ e $q_B$ con dei vincoli sono di tipo lineare:

$q_A + q_B <= Q$
$c_Aq_A + c_Bq_B <= C$


\begin{figure}[H]
\centering
\includegraphics[scale=0.3]{lottoec.jpeg}
\caption{Grafico con linee di livello non lineari} 
\label{linlivnonlin}
\end{figure}


La \hl{funzione obiettivo non e' lineare} dato che $q_A$ e $q_B$ sono al denominatore. Le \hl{curve di livello non sono delle rette} ma saranno concentriche (su ognuna il costo è sempre costante).

Avremo una \hl{soluzione ottima dalla curva di livello tangente all'insieme di ammissibilita'}. Si vado allora a prendere le curve peggiori fino ad arrivare a quella che interseca la regione ottima.


% Esempio modello di ottimizzazione con uso di matrici
\subsection{Esempio modello di ottimizzazione con uso di matrici}

Ogni problema di ottimizzazione lineare si può \hl{trasformare in forma standard}. Prendiamo un f.o.:

$$min z = c^T x$$

e dei vincoli:

\begin{itemize}
	\item $\underline{\underline{A}}\ \underline{x} = \underline{b}$
	\item $\underline{x} >= 0$
	\item $n > m$
\end{itemize}

con $n$ righe e $m$ colonne delle matrice $\underline{\underline{A}}$.

Utilizziamo l'\hl{operazione di Pivot}, quindi il vincolo:

$$\underline{\underline{A}}\ \underline{x} = \underline{b}$$

sarà:


$$
\left[ {\begin{array}{cccc}
	4 & 1 & 5 & 7 \\
	2 & 3 & 2 & 1 \\
\end{array} } \right]
\left[ {\begin{array}{c}
	x_1 \\
	x_2 \\
	x_3 \\
	x_4 \\
\end{array} } \right]
=
\left[ {\begin{array}{c}
	10 \\
	10 \\
\end{array} } \right]
$$

Il Pivot che ci viene assegnato è:

$$(r, s) = (1, 3)$$

alla quale coordinata corrisponde il valore della prima riga e terza colonna: $5$.

Dai dati \hl{creiamo un sistema di eq lineari}:

$$
\begin{cases} 
    4x_1 + x_2 + 5x_3 + 7x_4 = 10 \\ 
    2x_1 + 3x_2 + 2x_3 + 1x_4 = 10 
\end{cases}
$$

Per eseguire l'operazione di Pivot andremo a far si che \hl{in corrispondenza della colonna di Pivot ($s$) ci sia solo un vettore unitario}:

$$
\left[ {\begin{array}{cccc}
	? & ? & 1 & ? \\
	? & ? & 0 & ? \\
\end{array} } \right]
\left[ {\begin{array}{c}
	x_1 \\
	x_2 \\
	x_3 \\
	x_4 \\
\end{array} } \right]
=
\left[ {\begin{array}{c}
	? \\
	? \\
\end{array} } \right]
$$

Gli steps da seguire sono:

\begin{enumerate}
	\item facciamo \hl{$\frac{r}{a_{rs}}$}, con:
		
		\begin{itemize}
			\item $r$: riga Pivot
			\item $a_{rs} \neq 0$: valore che si trova dal Pivot, nel nostro caso $5$
		\end{itemize}
		
		Diremo quindi che:
		
		$$a_{rj} = \frac{a_{rj}}{a{rs}}\ \ \ \forall\ \ \ j = 1, ..., n+1$$

		$$
		\left[ {\begin{array}{cccc}
			\frac{4}{5} & \frac{1}{4} & 1 & \frac{7}{5} \\
			? & ? & 0 & ? \\
		\end{array} } \right]
		\left[ {\begin{array}{c}
			x_1 \\
			x_2 \\
			x_3 \\
			x_4 \\
		\end{array} } \right]
		=
		\left[ {\begin{array}{c}
			2 \\
			? \\
		\end{array} } \right]
		$$
	
	\item per ogni riga non Pivot $i \neq r$ applichiamo il principio di equivalenza per eq non lineari:
	
		$$\text{riga } i = \text{riga } i + (-a_{is}) * \text{nuova riga } r$$
		
		in questo caso andiamo a sommare $-2$ in modo da avere la configurazione $(1, 3) = 1$ e $(2, 3) = 0$.
		
		Diremo quindi che:
		
		$$a_{ij} = a{ij} + (-a{is})a_{rj}\ \ \ \forall\ \ \ i = 1, ..., m;\ i \neq r$$
		
		\begin{table}[!h]
		    \begin{center}
				\def\arraystretch{2}
		    	\begin{tabular}{| c c c c | c |}
		    	    \hline
		    	    \textbf{col 1} & \textbf{col 2} & \textbf{col 3} & \textbf{col 4} & \textbf{ris} \\\hline
		    	    $\ \ 2$ & $\ \ 3$ & $\ \ 2$ & $\ \ 1$ & $\ 10\ +$ \\
		     		$-\frac{8}{5}$ & $-\frac{2}{5}$ & $-2$ & $-\frac{14}{5}$ & $-4\ =$ \\\hline
		     		$\ \frac{2}{5}$ & $\ \frac{13}{5}$ & $\ \ 0$ & $-\frac{9}{5}$ & $\ \ 6$ \\
					\hline
		    \end{tabular}
		\end{center}
		\end{table}
		
		quindi abbiamo:
		
		$$
		\left[ {\begin{array}{cccc}
			\frac{4}{5} & \frac{1}{4} & 1 & \frac{7}{5} \\
			\frac{2}{5} & \frac{13}{5} & 0 & -\frac{9}{5} \\
		\end{array} } \right]
		\left[ {\begin{array}{c}
			x_1 \\
			x_2 \\
			x_3 \\
			x_4 \\
		\end{array} } \right]
		=
		\left[ {\begin{array}{c}
			2 \\
			6 \\
		\end{array} } \right]
		$$
	
\end{enumerate}

